<?xml version="1.0"?>

<xsd:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xsd:element name="CrisesDB">
        <xsd:complexType>
            <xsd:sequence>
                <xsd:element name="Crisis"
                    type="CrisisType"
                    minOccurs="0"
                    maxOccurs="unbounded"/>
                </xsd:element>
                <xsd:element name="Person"
                    type="PersonType"
                    minOccurs="0"
                    maxOccurs="unbounded"/>
                </xsd:element>
                <xsd:element name="Organization"
                    type="OrganizationType"
                    minOccurs="0"
                    maxOccurs="unbounded"/>
                </xsd:element>
            </xsd:sequence>
        </xsd:complexType>
        <xsd:key name="CrisisKey">
            <xsd:selector xpath="Crisis"/>
            <xsd:field    xpath="@crisisID"/>
        </xsd:key>
        <xsd:key name="PersonKey">
            <xsd:selector xpath="Person"/>
            <xsd:field    xpath="@personID"/>
        </xsd:key>
        <xsd:key name="OrganizationKey">
            <xsd:selector xpath="Organization"/>
            <xsd:field    xpath="@organizationID"/>
        </xsd:key>
        <xsd:keyRef name="PersonKeyCrisis" refer="PersonKey">
            <xsd:selector xpath="Crisis/Person"/>
            <xsd:field    xpath="@personID"/>
        </xsd:keyRef>
        <xsd:keyRef name="PersonKeyOrganization" refer="PersonKey">
            <xsd:selector xpath="Organization/Person"/>
            <xsd:field    xpath="@personID"/>
        </xsd:keyRef>
        <xsd:keyRef name="OrganizationKeyCrisis" refer="OrganizationKey">
            <xsd:selector xpath="Crisis/Organization"/>
            <xsd:field    xpath="@organizationID"/>
        </xsd:keyRef>
    </xsd:element>
    <xsd:complexType name="CrisisType">
        <xsd:attribute name="start" type="xsd:dateTime" use="required"/>
        <xsd:attribute name="crisisID" type="CrisisKey" use="required"/>
        <xsd:attribute name="name" type="xsd:string" use="required"/>

        <xsd:sequence>
            <xsd:element name="categories">
                <xsd:complexType>
                    <xsd:sequence>
                        <xsd:element name="category" maxOccurs="unbounded">
                            <xsd:complexType>
                                <xsd:attribute name="type" type="xsd:string" use="required" />
                            </xsd:complexType>
                        </xsd:element>
                    </xsd:sequence>
                </xsd:complexType>
            </xsd:element>

            <xsd:element name="locations">
                <xsd:complexType>
                    <xsd:element name="location" maxOccurs="unbounded">
                        <xsd:complexType>
                            <xsd:attribute name="lat" type="xsd:integer" use="required" />
                            <xsd:attribute name="lon" type="xsd:integer" use="required" />
                            <xsd:attribute name="radius" type="xsd:integer" use="required" />
                        </xsd:complexType>
                    </xsd:element>
                </xsd:complexType>
            </xsd:element>

            <xsd:element name="human-impact">
                <xsd:complexType>
                    <xsd:element maxOccurs="unbounded"> <!-- allow any name maybe? -->
                        <xsd:complexType>
                            <xsd:attribute name="count" type="xsd:integer" use="required" />
                        </xsd:complexType>
                    </xsd:element>
                </xsd:complexType>
            </xsd>

            <xsd:element name="economic-impact">
                <xsd:complexType>
                    <xsd:attribute name="amount" type="xsd:integer" use="requied" />
                    <xsd:attribute name="unit" type="xsd:string" use="required" />
                    <xsd:attribute name="estimated" type="xsd:boolean" />
                </xsd:complexType>
            </xsd:element>

            <xsd:element name="citations">
                <xsd:complexType>
                    <xsd:element name="ref" type="ref" maxOccurs="unbounded"/>
                </xsd:complexType>
            </xsd:element>

            <xsd:element name="external-resources">
                <xsd:complexType>
                    <xsd:element name="ref" type="ref" maxOccurs="unbounded"/>
                </xsd:complexType>
            </xsd:element>

            <xsd:element name="organizations">
                <xsd:complexType>
                    <xsd:element name="organization" maxOccurs="unbounded">
                        <xsd:attribute name="organizationID" type="OrganizationRef"/>
                    </xsd:element>
                </xsd:complexType>
            </xsd:element>

        </xsd:sequence>
    </xsd:complexType>  <!-- /end CrisisType -->    
    <xsd:complexType name="PersonType">
        <xsd:attribute name="">
    </xsd:complexType> <!-- /end PersonType -->
    <xsd:complexType name="OrganizationType">
    	<xsd:sequence>
            <xsd:element name="categories">
	        <xsd:complexType>
       	            <xsd:sequence>
                        <xsd:element name="category" maxOccurs="unbounded">
	                    <xsd:complexType>
        	                <xsd:attribute name="type" type="xsd:string" use="required" />
                	    </xsd:complexType>
	                </xsd:element>
        	    </xsd:sequence>
	        </xsd:complexType>
            </xsd:element>
    	    <xsd:element name="history" type="xsd:string" />
            <xsd:element name="contact-info">
    	        <xsd:complexType>
            	    <xsd:sequence>
    	                <xsd:element name="tel" type="xsd:integer" maxOccurs="unbounded">
           	            <xsd:complexType>
                   	        <xsd:attribute name="label" type="xsd:string" use="required" />
                            </xsd:complexType>
    	                </xsd:element>
            	        <xsd:element name="email" type="xsd:string" maxOccurs="unbounded">
                    	    <xsd:complexType>
                                <xsd:attribute name="label" type="xsd:string" use="required" />
    	                    </xsd:complexType>
            	        </xsd:element>
                    	<xsd:element name="address" maxOccurs="unbounded">
                            <xsd:complexType>
    	                        <xsd:sequence>
            	                    <xsd:element name="street" type="xsd:string" />
                    	            <xsd:element name="city" type="xsd:string" />
                            	    <xsd:element name="state" type="xsd:string" />
                                    <xsd:element name="zip" type="xsd:integer" />
    	                        </xsd:sequence>
            	                <xsd:attribute name="label" type="xsd:string" />
                    	    </xsd:complexType>
    	                </xsd:element>
            	    </xsd:sequence>
    	        </xsd:complexType>
            </xsd:element>
    	    <xsd:element name="external-resources">
            	<xsd:complexType>
                    <xsd:sequence>
    	                <xsd:element name="ref" type="xsd:string">
                            <xsd:complexType>
                     	        <xsd:attribute name="type" type="xsd:string" use="required" />
                            </xsd:complexType>
    	                </xsd:element>
            	    </xsd:sequence>
    	        </xsd:complexType>
            </xsd:element>
    	    <xsd:element name="People">
            	<xsd:complexType>
                    <xsd:sequence>
    	                <xsd:element name="Person" maxOccurs="unbounded">
            	            <xsd:complexType>
                    	        <xsd:attribute name="personID" type="xsd:string" use="required" />
                            </xsd:complexType>
    	                </xsd:element>
            	    </xsd:sequence>
    	        </xsd:complexType>
            </xsd:element>
    	    <xsd:complexType>
            	<xsd:attribute name="name" type="xsd:string" use="required" />
    	        <xsd:attribute name="organizationID" type="xsd:string" use="required" />
            </xsd:complexType>
	</xsd:sequence>
    </xsd:complexType>
</xsd:schema>
      
